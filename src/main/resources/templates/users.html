<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</title>
  <style>
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    th, td {
        border: 1px solid black;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
    }
      .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
  }
  .modal-content {
      background-color: white;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 30%;
  }
  .close {
      float: right;
      font-size: 28px;
      cursor: pointer;
  }
  </style>
</head>
<body>

<h2>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>

<button id="openUserModal">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>

<div id="userModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
    <form id="userForm" method="post" th:action="@{/admin/users/create}" th:object="${userDto}">
      <label for="firstName">–ò–º—è:</label>
      <input type="text" id="firstName" th:field="*{firstName}" required>

      <label for="username">–õ–æ–≥–∏–Ω:</label>
      <input type="text" id="username" th:field="*{username}" required>

      <label for="password">–ü–∞—Ä–æ–ª—å:</label>
      <input type="password" id="password" th:field="*{password}" required>

      <button type="submit">–°–æ–∑–¥–∞—Ç—å</button>
    </form>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    let modal = document.getElementById("userModal");
    let openBtn = document.getElementById("openUserModal");
    let closeBtn = document.querySelector(".close");

    openBtn.onclick = function() {
      modal.style.display = "block";
    };
    closeBtn.onclick = function() {
      modal.style.display = "none";
    };
    window.onclick = function(event) {
      if (event.target === modal) {
        modal.style.display = "none";
      }
    };
  });
</script>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<form method="get" action="/admin/users">
  <label for="username">–ü–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∏–Ω—É:</label>
  <input type="text" id="usrname" name="username" th:value="${param.username}">

  <label for="role">–§–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏:</label>
  <select id="role" name="role">
    <option value="">–í—Å–µ</option>
    <option th:each="role : ${allRoles}"
            th:value="${role}"
            th:text="${role}"
            th:selected="${param.role == role}"></option>
  </select>

  <button type="submit">üîç –ü–æ–∏—Å–∫</button>
  <a href="/admin/users"><button type="button">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button></a>
</form>

<table>
  <thead>
  <tr>
    <th>ID</th>
    <th>–ò–º—è</th>
    <th>–õ–æ–≥–∏–Ω</th>
    <th>–†–æ–ª–∏</th>
    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="user : ${users}">
    <td th:text="${user.id}"></td>
    <td th:text="${user.firstName}"></td>
    <td th:text="${user.username}"></td>
    <td>
      <span th:each="role : ${user.roles}" th:text="${role} + ' '"></span>
    </td>
    <td>
      <a th:href="@{/users/edit/{id}(id=${user.id})}">‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
      <form th:action="@{/admin/users/{userId}(userId=${user.id})}" method="post">
        <button type="submit" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å\–î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')">
          –ê–¥–º–∏–Ω
        </button>
      </form>
      <form th:action="@{/admin/users/{userId}/delete(userId=${user.id})}" method="post">
        <button type="submit" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')">
          –£–¥–∞–ª–∏—Ç—å
        </button>
      </form>
    </td>
  </tr>
  </tbody>
</table>

<script>

</script>

<a th:href="@{/admin}">–ö —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–¥–º–∏–Ω–∞</a>
</body>
</html>